import{r as m,j as e,a as ce,b as ie,c as ne,F as de,d as me,e as he,f as ue,h as xe,i as pe,k as ge}from"./index-CQ6-uO2I.js";import{H as fe}from"./HeaderSection-EkqSG3K4.js";import{A as je}from"./AdminModal-r6pp9zG0.js";const be=()=>{const t=m.useRef(null);return m.useEffect(()=>{const g=new IntersectionObserver(x=>{x.forEach(o=>{o.isIntersecting&&(o.target.classList.add("visible"),g.unobserve(o.target))})},{threshold:.1,rootMargin:"50px 0px -50px 0px"});return t.current&&t.current.querySelectorAll(".timeline-item, .chronological-item").forEach(o=>g.observe(o)),()=>{t.current&&t.current.querySelectorAll(".timeline-item, .chronological-item").forEach(o=>g.unobserve(o))}},[]),t},ee=(t,g)=>{const x=re(t),o=re(g);return o.toLowerCase()==="presente"?`${x} - Presente`:`${x} - ${o}`},ae=(t,g)=>{const x=d=>{const S=d.toLowerCase();if(S==="presente"||S==="current"){const E=new Date;return E.getFullYear()*12+E.getMonth()}if(/^\d{4}$/.test(d))return parseInt(d)*12;if(/^\d{4}-\d{2}$/.test(d)){const[E,M]=d.split("-"),B=parseInt(E),v=parseInt(M)-1;return B*12+v}const j=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],[w,F]=d.split(" "),R=j.indexOf(w),T=parseInt(F);if(R!==-1&&!isNaN(T))return T*12+R;const $=parseInt(d);return isNaN($)?0:$*12},o=x(t),h=x(g)-o;if(h<0)return"Duración inválida";if(h===0)return"Menos de 1 mes";if(h<12)return h===1?"1 mes":`${h} meses`;const N=Math.floor(h/12),D=h%12;if(D===0)return N===1?"1 año":`${N} años`;const c=N===1?"1 año":`${N} años`,C=D===1?"1 mes":`${D} meses`;return`${c} y ${C}`},re=t=>{if(!t)return"";const g=t.toLowerCase();if(g==="presente"||g==="current")return"Presente";if(/^\d{4}-\d{2}$/.test(t)){const x=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],[o,b]=t.split("-"),h=parseInt(o),N=parseInt(b)-1;if(N>=0&&N<12)return`${x[N]} ${h}`}return t},Ne=({experience:t,index:g,animationDelay:x=.1,showDuration:o=!0})=>e.jsxs("div",{className:"timeline-item",style:{animationDelay:`${g*x}s`},children:[e.jsx("div",{className:"timeline-marker",children:e.jsx("div",{className:"marker-dot"})}),e.jsxs("div",{className:"timeline-content",children:[e.jsxs("div",{className:"timeline-header",children:[e.jsx("h4",{className:"timeline-title",children:t.title}),e.jsxs("div",{className:"timeline-period",children:[e.jsx("i",{className:"fas fa-calendar-alt"}),e.jsx("span",{children:ee(t.start_date,t.end_date)})]})]}),e.jsxs("p",{className:"timeline-company",children:[e.jsx("i",{className:"fas fa-building"}),t.company]}),o&&e.jsxs("div",{className:"timeline-duration",children:[e.jsx("i",{className:"fas fa-clock"}),e.jsx("span",{children:ae(t.start_date,t.end_date)})]}),e.jsx("p",{className:"timeline-description",children:t.description}),t.technologies&&t.technologies.length>0&&e.jsxs("div",{className:"timeline-skills",children:[e.jsxs("div",{className:"skills-label",children:[e.jsx("i",{className:"fas fa-tools"}),e.jsx("span",{children:"Tecnologías:"})]}),e.jsx("div",{className:"skills-tags",children:t.technologies.map((b,h)=>e.jsx("span",{className:"timeline-skill",children:b},h))})]}),t.end_date.toLowerCase()==="presente"&&e.jsxs("div",{className:"current-position-badge",children:[e.jsx("i",{className:"fas fa-star"}),e.jsx("span",{children:"Posición Actual"})]})]})]}),_e=({education:t,index:g,animationDelay:x=.1,showDuration:o=!0})=>e.jsxs("div",{className:"timeline-item education-item",style:{animationDelay:`${g*x}s`},children:[e.jsx("div",{className:"timeline-marker education-marker",children:e.jsx("div",{className:"marker-dot"})}),e.jsxs("div",{className:"timeline-content",children:[e.jsxs("div",{className:"timeline-header",children:[e.jsx("h4",{className:"timeline-title",children:t.title}),e.jsxs("div",{className:"timeline-period",children:[e.jsx("i",{className:"fas fa-calendar-alt"}),e.jsx("span",{children:ee(t.start_date,t.end_date)})]})]}),e.jsxs("p",{className:"timeline-company",children:[e.jsx("i",{className:"fas fa-university"}),t.institution]}),o&&e.jsxs("div",{className:"timeline-duration",children:[e.jsx("i",{className:"fas fa-clock"}),e.jsx("span",{children:ae(t.start_date,t.end_date)})]}),t.description&&e.jsx("p",{className:"timeline-description",children:t.description}),t.grade&&e.jsxs("div",{className:"education-grade",children:[e.jsx("i",{className:"fas fa-medal"}),e.jsxs("span",{children:["Calificación: ",t.grade]})]})]})]}),ve=({item:t,index:g,position:x,animationDelay:o=.15})=>e.jsxs("div",{className:`chronological-item ${t.type} ${x}`,style:{animationDelay:`${g*o}s`},children:[e.jsxs("div",{className:"chronological-marker",children:[e.jsx("div",{className:`marker-dot ${t.type}`,children:e.jsx("i",{className:t.type==="experience"?"fas fa-briefcase":"fas fa-graduation-cap"})}),e.jsx("div",{className:"chronological-year-external",children:t.end_date})]}),e.jsxs("div",{className:"chronological-content",children:[e.jsx("div",{className:"chronological-header",children:e.jsx("div",{className:`chronological-type ${t.type}`,children:t.type==="experience"?"Experiencia":"Formación"})}),e.jsx("h4",{className:"chronological-title",children:t.title}),e.jsxs("p",{className:"chronological-company",children:[e.jsx("i",{className:t.type==="experience"?"fas fa-building":"fas fa-university"}),t.type==="experience"?t.company:t.institution]}),e.jsxs("div",{className:"chronological-period",children:[e.jsx("i",{className:"fas fa-calendar-alt"}),e.jsx("span",{children:ee(t.start_date,t.end_date)})]}),e.jsxs("div",{className:"chronological-duration",children:[e.jsx("i",{className:"fas fa-hourglass-half"}),e.jsx("span",{children:ae(t.start_date,t.end_date)})]}),e.jsx("p",{className:"chronological-description",children:t.description}),t.type==="experience"&&t.technologies&&t.technologies.length>0&&e.jsxs("div",{className:"chronological-skills",children:[e.jsxs("div",{className:"skills-label",children:[e.jsx("i",{className:"fas fa-tools"}),e.jsx("span",{children:"Tecnologías:"})]}),e.jsx("div",{className:"skills-tags",children:t.technologies.map((b,h)=>e.jsx("span",{className:"timeline-skill",children:b},h))})]}),t.type==="education"&&t.grade&&e.jsxs("div",{className:"education-grade",children:[e.jsx("i",{className:"fas fa-medal"}),e.jsxs("span",{children:["Calificación: ",t.grade]})]})]})]}),ye="_modalOverlay_11gbb_70",Ee="_modalContainer_11gbb_91",Ce="_modalHeader_11gbb_118",Se="_headerTop_11gbb_127",Te="_backButton_11gbb_134",$e="_modalTitle_11gbb_159",ke="_progressIndicator_11gbb_176",Ae="_progressBar_11gbb_183",we="_progressFill_11gbb_192",Fe="_progressText_11gbb_216",Ie="_modalContent_11gbb_226",Le="_form_11gbb_232",De="_formSection_11gbb_240",Me="_sectionTitle_11gbb_265",Be="_formGrid_11gbb_281",Pe="_formField_11gbb_289",Re="_label_11gbb_295",Ge="_input_11gbb_312",Oe="_inputValid_11gbb_339",Ve="_inputError_11gbb_344",ze="_inputDisabled_11gbb_349",He="_textarea_11gbb_356",Je="_textareaError_11gbb_378",qe="_textareaContainer_11gbb_383",Ue="_characterCounter_11gbb_387",Ke="_warning_11gbb_400",Ye="_error_11gbb_406",We="_helperText_11gbb_413",Qe="_errorText_11gbb_419",Xe="_dateRangeContainer_11gbb_446",Ze="_currentToggle_11gbb_453",ea="_checkbox_11gbb_463",aa="_checkboxLabel_11gbb_470",sa="_technologyContainer_11gbb_480",ta="_technologyInput_11gbb_484",ia="_suggestions_11gbb_502",na="_suggestionItem_11gbb_517",ra="_technologyChips_11gbb_537",ca="_chip_11gbb_544",oa="_chipRemove_11gbb_579",la="_stickyFooter_11gbb_602",da="_footerContent_11gbb_618",ma="_saveIndicator_11gbb_625",ha="_actions_11gbb_634",ua="_button_11gbb_640",xa="_buttonPrimary_11gbb_661",pa="_buttonSecondary_11gbb_673",ga="_spinning_11gbb_710",fa="_shortcuts_11gbb_720",s={modalOverlay:ye,modalContainer:Ee,modalHeader:Ce,headerTop:Se,backButton:Te,modalTitle:$e,progressIndicator:ke,progressBar:Ae,progressFill:we,progressText:Fe,modalContent:Ie,form:Le,formSection:De,sectionTitle:Me,formGrid:Be,formField:Pe,label:Re,input:Ge,inputValid:Oe,inputError:Ve,inputDisabled:ze,textarea:He,textareaError:Je,textareaContainer:qe,characterCounter:Ue,warning:Ke,error:Ye,helperText:We,errorText:Qe,dateRangeContainer:Xe,currentToggle:Ze,checkbox:ea,checkboxLabel:aa,technologyContainer:sa,technologyInput:ta,suggestions:ia,suggestionItem:na,technologyChips:ra,chip:ca,chipRemove:oa,stickyFooter:la,footerContent:da,saveIndicator:ma,actions:ha,button:ua,buttonPrimary:xa,buttonSecondary:pa,spinning:ga,shortcuts:fa},ja=["React","Vue.js","Angular","JavaScript","TypeScript","Node.js","Express.js","Python","Django","Flask","Java","Spring Boot","C#",".NET","PHP","Laravel","HTML5","CSS3","SASS","SCSS","Tailwind CSS","Bootstrap","Material-UI","MongoDB","PostgreSQL","MySQL","Redis","Docker","Kubernetes","AWS","Azure","Git","GitHub","GitLab","Jenkins","Jest","Cypress","Webpack","Vite"],ba=({isOpen:t,onClose:g,formType:x,initialData:o={},isEditing:b,onSubmit:h})=>{const{showError:N,showSuccess:D}=ce(),[c,C]=m.useState({title:"",company:"",institution:"",start_date:"",end_date:"",description:"",technologies:"",grade:"",order_index:0,is_current:!1,...o}),[d,S]=m.useState({}),[j,w]=m.useState({}),[F,R]=m.useState(!1),[T,$]=m.useState(""),[E,M]=m.useState([]),[B,v]=m.useState(!1),[G,V]=m.useState(0),z=m.useRef(null),H=m.useRef(null);m.useEffect(()=>{const i=x==="experience"?["title","company","start_date"]:["title","institution","start_date"],l=i.filter(y=>{var Q;return(Q=c[y])==null?void 0:Q.toString().trim()}).length,f=c.description?1:0,_=i.length+1,L=Math.round((l+f)/_*100);V(L)},[c,x]),m.useEffect(()=>{c.technologies&&M(c.technologies.split(",").map(i=>i.trim()).filter(Boolean))},[c.technologies]);const O=(i,l)=>{switch(i){case"title":if(!l.trim())return"El título es obligatorio";if(l.length<2)return"El título debe tener al menos 2 caracteres";break;case"company":case"institution":if(!l.trim())return`${x==="experience"?"La empresa":"La institución"} es obligatoria`;if(l.length<2)return"Debe tener al menos 2 caracteres";break;case"start_date":if(!l)return"La fecha de inicio es obligatoria";break;case"end_date":if(!l&&!c.is_current)return"La fecha de fin es obligatoria";if(l&&c.start_date&&l<c.start_date)return"La fecha de fin debe ser posterior a la de inicio";break;case"description":if(l.length>500)return"La descripción no puede exceder 500 caracteres";break}return null},k=(i,l)=>{C(_=>({..._,[i]:l})),w(_=>({..._,[i]:!0}));const f=O(i,l);S(_=>{const L={..._};return f?L[i]=f:delete L[i],L})},K=()=>{const i=!c.is_current;C(l=>({...l,is_current:i,end_date:i?"":l.end_date})),i&&S(l=>{const f={...l};return delete f.end_date,f})},I=i=>{if(i.trim()&&!E.includes(i.trim())){const l=[...E,i.trim()];M(l),C(f=>({...f,technologies:l.join(", ")})),$(""),v(!1)}},J=i=>{const l=E.filter((f,_)=>_!==i);M(l),C(f=>({...f,technologies:l.join(", ")}))},X=i=>{$(i),v(i.length>0)},Y=i=>{i.key==="Enter"&&T.trim()&&(i.preventDefault(),I(T))},q=()=>ja.filter(i=>i.toLowerCase().includes(T.toLowerCase())&&!E.includes(i)).slice(0,8),W=()=>{const i={};if((x==="experience"?[{name:"title",value:c.title},{name:"company",value:c.company||""},{name:"start_date",value:c.start_date}]:[{name:"title",value:c.title},{name:"institution",value:c.institution||""},{name:"start_date",value:c.start_date}]).forEach(({name:_,value:L})=>{const y=O(_,L);y&&(i[_]=y)}),!c.is_current){const _=O("end_date",c.end_date);_&&(i.end_date=_)}const f=O("description",c.description);return f&&(i.description=f),S(i),Object.keys(i).length===0},U=async i=>{if(i.preventDefault(),!W()){N("Errores de Validación","Por favor corrige los errores antes de continuar");return}R(!0);try{await h(c),D(`${x==="experience"?"Experiencia":"Educación"} ${b?"Actualizada":"Creada"}`,`Se ha ${b?"actualizado":"creado"} "${c.title}" correctamente`),g()}catch(l){N("Error al Guardar",l instanceof Error?l.message:"Error desconocido")}finally{R(!1)}};if(m.useEffect(()=>{const i=l=>{t&&(l.key==="Escape"?g():l.ctrlKey&&l.key==="Enter"&&U(l))};return document.addEventListener("keydown",i),()=>document.removeEventListener("keydown",i)},[t]),!t)return null;const p=x==="experience",Z=b?`Editar ${p?"Experiencia":"Educación"}`:`Nueva ${p?"Experiencia":"Educación"}`;return e.jsx("div",{className:s.modalOverlay,children:e.jsxs("div",{className:s.modalContainer,children:[e.jsxs("div",{className:s.modalHeader,children:[e.jsxs("div",{className:s.headerTop,children:[e.jsx("button",{type:"button",className:s.backButton,onClick:g,"aria-label":"Cerrar formulario",children:e.jsx("i",{className:"fas fa-times"})}),e.jsxs("h2",{className:s.modalTitle,children:[e.jsx("i",{className:`fas ${p?"fa-briefcase":"fa-graduation-cap"}`}),Z]})]}),e.jsxs("div",{className:s.progressIndicator,children:[e.jsx("div",{className:s.progressBar,children:e.jsx("div",{className:s.progressFill,style:{width:`${G}%`}})}),e.jsxs("span",{className:s.progressText,children:["Completado: ",G,"%"]})]})]}),e.jsx("div",{className:s.modalContent,children:e.jsxs("form",{ref:z,onSubmit:U,className:s.form,children:[e.jsxs("div",{className:s.formSection,children:[e.jsxs("h3",{className:s.sectionTitle,children:[e.jsx("i",{className:"fas fa-info-circle"}),"Información Básica"]}),e.jsxs("div",{className:s.formGrid,children:[e.jsxs("div",{className:s.formField,children:[e.jsxs("label",{className:s.label,children:[e.jsx("i",{className:`fas ${p?"fa-briefcase":"fa-graduation-cap"}`}),p?"Título del puesto":"Título o grado"," *"]}),e.jsx("input",{type:"text",value:c.title,onChange:i=>k("title",i.target.value),className:`${s.input} ${j.title&&d.title?s.inputError:j.title&&!d.title?s.inputValid:""}`,placeholder:p?"Ej: Desarrollador Full Stack Senior":"Ej: Grado en Ingeniería Informática"}),e.jsx("div",{className:s.helperText,children:p?"Especifica tu rol o cargo principal":"Indica el nombre completo del título"}),j.title&&d.title&&e.jsxs("div",{className:s.errorText,children:[e.jsx("i",{className:"fas fa-exclamation-triangle"}),d.title]})]}),e.jsxs("div",{className:s.formField,children:[e.jsxs("label",{className:s.label,children:[e.jsx("i",{className:`fas ${p?"fa-building":"fa-university"}`}),p?"Empresa":"Institución"," *"]}),e.jsx("input",{type:"text",value:p?c.company||"":c.institution||"",onChange:i=>k(p?"company":"institution",i.target.value),className:`${s.input} ${j[p?"company":"institution"]&&d[p?"company":"institution"]?s.inputError:j[p?"company":"institution"]&&!d[p?"company":"institution"]?s.inputValid:""}`,placeholder:p?"Ej: TechCorp Solutions":"Ej: Universidad Tecnológica"}),e.jsx("div",{className:s.helperText,children:p?"Nombre de la empresa u organización":"Nombre de la universidad o centro educativo"}),j[p?"company":"institution"]&&d[p?"company":"institution"]&&e.jsxs("div",{className:s.errorText,children:[e.jsx("i",{className:"fas fa-exclamation-triangle"}),d[p?"company":"institution"]]})]})]})]}),e.jsxs("div",{className:s.formSection,children:[e.jsxs("h3",{className:s.sectionTitle,children:[e.jsx("i",{className:"fas fa-calendar-alt"}),"Período de Tiempo"]}),e.jsxs("div",{className:s.dateRangeContainer,children:[e.jsxs("div",{className:s.formGrid,children:[e.jsxs("div",{className:s.formField,children:[e.jsxs("label",{className:s.label,children:[e.jsx("i",{className:"fas fa-play"}),"Fecha de inicio *"]}),e.jsx("input",{type:"month",value:c.start_date,onChange:i=>k("start_date",i.target.value),className:`${s.input} ${j.start_date&&d.start_date?s.inputError:j.start_date&&!d.start_date?s.inputValid:""}`}),j.start_date&&d.start_date&&e.jsxs("div",{className:s.errorText,children:[e.jsx("i",{className:"fas fa-exclamation-triangle"}),d.start_date]})]}),e.jsxs("div",{className:s.formField,children:[e.jsxs("label",{className:s.label,children:[e.jsx("i",{className:"fas fa-stop"}),"Fecha de fin ",!c.is_current&&"*"]}),e.jsx("input",{type:"month",value:c.end_date,onChange:i=>k("end_date",i.target.value),disabled:c.is_current,className:`${s.input} ${c.is_current?s.inputDisabled:j.end_date&&d.end_date?s.inputError:j.end_date&&!d.end_date?s.inputValid:""}`,placeholder:c.is_current?"Actualidad":""}),j.end_date&&d.end_date&&e.jsxs("div",{className:s.errorText,children:[e.jsx("i",{className:"fas fa-exclamation-triangle"}),d.end_date]})]})]}),e.jsxs("div",{className:s.currentToggle,children:[e.jsx("input",{type:"checkbox",id:"current-toggle",checked:c.is_current,onChange:K,className:s.checkbox}),e.jsx("label",{htmlFor:"current-toggle",className:s.checkboxLabel,children:p?"Trabajo actual":"Estudios en curso"})]})]})]}),p&&e.jsxs("div",{className:s.formSection,children:[e.jsxs("h3",{className:s.sectionTitle,children:[e.jsx("i",{className:"fas fa-code"}),"Tecnologías y Herramientas"]}),e.jsxs("div",{className:s.formField,children:[e.jsxs("label",{className:s.label,children:[e.jsx("i",{className:"fas fa-tools"}),"Tecnologías utilizadas"]}),e.jsxs("div",{className:s.technologyContainer,children:[e.jsx("input",{ref:H,type:"text",value:T,onChange:i=>X(i.target.value),onKeyDown:Y,onFocus:()=>v(T.length>0),onBlur:()=>setTimeout(()=>v(!1),200),className:s.technologyInput,placeholder:"Escribe y presiona Enter para agregar..."}),B&&q().length>0&&e.jsx("div",{className:s.suggestions,children:q().map(i=>e.jsx("div",{className:s.suggestionItem,onClick:()=>I(i),children:i},i))})]}),E.length>0&&e.jsx("div",{className:s.technologyChips,children:E.map((i,l)=>e.jsxs("span",{className:s.chip,children:[i,e.jsx("button",{type:"button",onClick:()=>J(l),className:s.chipRemove,"aria-label":`Eliminar ${i}`,children:e.jsx("i",{className:"fas fa-times"})})]},l))}),e.jsx("div",{className:s.helperText,children:"Agrega las tecnologías más relevantes de este puesto"})]})]}),!p&&e.jsxs("div",{className:s.formSection,children:[e.jsxs("h3",{className:s.sectionTitle,children:[e.jsx("i",{className:"fas fa-medal"}),"Detalles Académicos"]}),e.jsxs("div",{className:s.formGrid,children:[e.jsxs("div",{className:s.formField,children:[e.jsxs("label",{className:s.label,children:[e.jsx("i",{className:"fas fa-star"}),"Calificación"]}),e.jsx("input",{type:"text",value:c.grade||"",onChange:i=>k("grade",i.target.value),className:s.input,placeholder:"Ej: Sobresaliente, 8.5/10, Matrícula de Honor"}),e.jsx("div",{className:s.helperText,children:"Nota media, mención o reconocimiento obtenido"})]}),e.jsxs("div",{className:s.formField,children:[e.jsxs("label",{className:s.label,children:[e.jsx("i",{className:"fas fa-sort-numeric-up"}),"Orden de visualización"]}),e.jsx("input",{type:"number",value:c.order_index||0,onChange:i=>k("order_index",i.target.value),className:s.input,min:"0",placeholder:"0"}),e.jsx("div",{className:s.helperText,children:"Número para ordenar la visualización"})]})]})]}),e.jsxs("div",{className:s.formSection,children:[e.jsxs("h3",{className:s.sectionTitle,children:[e.jsx("i",{className:"fas fa-align-left"}),"Descripción y Detalles"]}),e.jsxs("div",{className:s.formField,children:[e.jsxs("label",{className:s.label,children:[e.jsx("i",{className:"fas fa-file-text"}),"Descripción"]}),e.jsxs("div",{className:s.textareaContainer,children:[e.jsx("textarea",{value:c.description,onChange:i=>k("description",i.target.value),className:`${s.textarea} ${j.description&&d.description?s.textareaError:""}`,rows:5,maxLength:500,placeholder:p?"Describe tus responsabilidades, logros y proyectos destacados...":"Describe la especialización, proyectos destacados, etc..."}),e.jsxs("div",{className:`${s.characterCounter} ${c.description.length>450?s.warning:c.description.length>480?s.error:""}`,children:[c.description.length,"/500 caracteres"]})]}),j.description&&d.description&&e.jsxs("div",{className:s.errorText,children:[e.jsx("i",{className:"fas fa-exclamation-triangle"}),d.description]}),e.jsx("div",{className:s.helperText,children:"Máximo 500 caracteres. Enfócate en logros y responsabilidades clave"})]})]})]})}),e.jsxs("div",{className:s.stickyFooter,children:[e.jsxs("div",{className:s.footerContent,children:[e.jsx("div",{className:s.saveIndicator,children:F&&e.jsxs(e.Fragment,{children:[e.jsx("i",{className:`fas fa-spinner ${s.spinning}`}),"Guardando cambios..."]})}),e.jsxs("div",{className:s.actions,children:[e.jsxs("button",{type:"button",onClick:g,disabled:F,className:`${s.button} ${s.buttonSecondary}`,children:[e.jsx("i",{className:"fas fa-times"}),"Cancelar"]}),e.jsx("button",{type:"submit",onClick:U,disabled:F||Object.keys(d).length>0,className:`${s.button} ${s.buttonPrimary}`,children:F?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:`fas fa-spinner ${s.spinning}`}),"Guardando..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-save"}),b?"Guardar Cambios":`Crear ${p?"Experiencia":"Educación"}`]})})]})]}),e.jsxs("div",{className:s.shortcuts,children:[e.jsxs("span",{children:[e.jsx("kbd",{children:"Esc"})," Cerrar"]}),e.jsxs("span",{children:[e.jsx("kbd",{children:"Ctrl"})," + ",e.jsx("kbd",{children:"Enter"})," Guardar"]})]})]})]})})},ya=({className:t,showAdminFAB:g=!1,onAdminClick:x})=>{const[o,b]=m.useState([]),[h,N]=m.useState([]),[D,c]=m.useState(!0),[C,d]=m.useState(null),[S,j]=m.useState("traditional"),[w,F]=m.useState(0),[R,T]=m.useState(!1),[$,E]=m.useState("experience"),[M,B]=m.useState(!1),[v,G]=m.useState(null),[V,z]=m.useState(null),[H,O]=m.useState({title:"",company:"",start_date:"",end_date:"",description:"",technologies:"",order_index:0}),[k,K]=m.useState({title:"",institution:"",start_date:"",end_date:"",description:"",grade:"",order_index:0}),{showSuccess:I,showError:J}=ce(),X=be(),Y=m.useCallback(async()=>{try{const a=await ie();N(a)}catch(a){console.error("Error loading education:",a)}},[]),q=m.useCallback(async()=>{if(!(w>=3)){c(!0),d(null);try{const a=await ne();b(a),c(!1),F(0)}catch{F(r=>r+1),d(`Error al cargar experiencias (Intento ${w+1}/3)`),c(!1),w<2&&setTimeout(()=>q(),2e3)}}},[w]);m.useEffect(()=>{(async()=>{try{const[r,n]=await Promise.allSettled([ne(),ie()]);r.status==="fulfilled"?b(r.value):(console.error("Error loading experiences:",r.reason),d("Usando datos de ejemplo para experiencias (API no disponible)")),n.status==="fulfilled"?N(n.value):(console.error("Error loading education:",n.reason),await Y(),C||d("Usando datos de ejemplo para educación (API no disponible)")),c(!1)}catch(r){console.error("Error loading data:",r),d("Error al cargar datos"),c(!1)}})()},[Y]);const W=m.useCallback(a=>{j(a)},[]),U=a=>{var r;O({title:a.title,company:a.company,start_date:a.start_date,end_date:a.end_date,description:a.description||"",technologies:((r=a.technologies)==null?void 0:r.join(", "))||"",order_index:a.order_index}),G(a.id),z("experience"),B(!0)},p=a=>{K({title:a.title,institution:a.institution,start_date:a.start_date,end_date:a.end_date,description:a.description||"",grade:a.grade||"",order_index:a.order_index||0}),G(a.id),z("education"),B(!0)},Z=async(a,r)=>{if(confirm(`¿Estás seguro de eliminar la experiencia "${r}"?`))try{await pe(a),b(n=>Array.isArray(n)?n.filter(u=>u.id!==a):[]),I("Experiencia Eliminada",`Se ha eliminado "${r}" correctamente`)}catch(n){console.error("Error eliminando experiencia:",n),J("Error","No se pudo eliminar la experiencia laboral")}},i=async(a,r)=>{if(confirm(`¿Estás seguro de eliminar la formación "${r}"?`))try{await ge(a),N(n=>Array.isArray(n)?n.filter(u=>u.id!==a):[]),I("Formación Eliminada",`Se ha eliminado "${r}" correctamente`)}catch(n){console.error("Error eliminando educación:",n),J("Error","No se pudo eliminar la formación académica")}},l=()=>{se(),G(null),z($),B(!0)},f=()=>{B(!1),G(null),z(null),se()},_=()=>!Array.isArray(o)||o.length===0?e.jsxs("div",{className:"admin-empty",children:[e.jsx("i",{className:"fas fa-briefcase"}),e.jsx("h3",{children:"No hay experiencias"}),e.jsx("p",{children:"Añade la primera experiencia laboral usando el botón flotante."})]}):e.jsx("div",{className:"admin-items-list",children:o.sort((a,r)=>{const n=y(a.end_date);return y(r.end_date)-n}).map(a=>e.jsxs("div",{className:"admin-item-card",children:[e.jsxs("div",{className:"admin-item-header",children:[e.jsx("div",{className:"admin-item-image",children:e.jsx("div",{className:"admin-item-icon",children:e.jsx("i",{className:"fas fa-briefcase"})})}),e.jsxs("div",{className:"admin-item-info",children:[e.jsx("h3",{className:"admin-item-title",children:a.title}),e.jsx("p",{className:"admin-item-subtitle",children:a.company}),"                ",e.jsx("div",{className:"admin-exp-metadata",children:e.jsxs("div",{className:"admin-item-date",children:[e.jsx("i",{className:"fas fa-calendar-alt"}),e.jsxs("span",{children:[a.start_date," - ",a.end_date]})]})}),a.description&&e.jsx("div",{className:"admin-item-description",children:e.jsx("p",{children:a.description.length>100?`${a.description.substring(0,100)}...`:a.description})}),a.technologies&&a.technologies.length>0&&e.jsx("div",{className:"admin-item-technologies",children:e.jsx("div",{className:"admin-tech-list",children:a.technologies.map((r,n)=>e.jsx("span",{className:"admin-tech-tag",children:r},n))})})]})]}),e.jsxs("div",{className:"admin-item-actions",children:[e.jsxs("button",{className:"admin-btn-secondary",onClick:()=>U(a),children:[e.jsx("i",{className:"fas fa-edit"}),"Editar"]}),e.jsxs("button",{className:"admin-btn-danger",onClick:()=>Z(a.id,a.title),children:[e.jsx("i",{className:"fas fa-trash"}),"Eliminar"]})]})]},a.id))}),L=()=>!Array.isArray(h)||h.length===0?e.jsxs("div",{className:"admin-empty",children:[e.jsx("i",{className:"fas fa-graduation-cap"}),e.jsx("h3",{children:"No hay formación académica"}),e.jsx("p",{children:"Añade la primera formación académica usando el botón flotante."})]}):e.jsx("div",{className:"admin-items-list",children:h.sort((a,r)=>{const n=y(a.end_date);return y(r.end_date)-n}).map(a=>e.jsxs("div",{className:"admin-item-card",children:[e.jsxs("div",{className:"admin-item-header",children:[e.jsx("div",{className:"admin-item-image",children:e.jsx("div",{className:"admin-item-icon",children:e.jsx("i",{className:"fas fa-graduation-cap"})})}),e.jsxs("div",{className:"admin-item-info",children:[e.jsx("h3",{className:"admin-item-title",children:a.title}),e.jsx("p",{className:"admin-item-subtitle",children:a.institution}),e.jsxs("div",{className:"admin-edu-metadata",children:[e.jsxs("div",{className:"admin-item-date",children:[e.jsx("i",{className:"fas fa-calendar-alt"}),e.jsxs("span",{children:[a.start_date," - ",a.end_date]})]}),a.grade&&e.jsxs("div",{className:"admin-item-grade",children:[e.jsx("i",{className:"fas fa-medal"}),e.jsx("span",{children:a.grade})]})]}),a.description&&e.jsx("div",{className:"admin-item-description",children:e.jsx("p",{children:a.description.length>100?`${a.description.substring(0,100)}...`:a.description})})]})]}),e.jsxs("div",{className:"admin-item-actions",children:[e.jsxs("button",{className:"admin-btn-secondary",onClick:()=>p(a),children:[e.jsx("i",{className:"fas fa-edit"}),"Editar"]}),e.jsxs("button",{className:"admin-btn-danger",onClick:()=>i(a.id,a.title),children:[e.jsx("i",{className:"fas fa-trash"}),"Eliminar"]})]})]},a.id))}),y=a=>{if(a==="Presente")return new Date().getFullYear()*12+new Date().getMonth();if(/^\d{4}$/.test(a))return parseInt(a)*12;const r=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],[n,u]=a.split(" "),P=r.indexOf(n),A=parseInt(u);if(P!==-1&&!isNaN(A))return A*12+P;const te=parseInt(a);return isNaN(te)?0:te*12},Q=async a=>{try{if(V==="experience"){const n={title:a.title,company:a.company,start_date:a.start_date,end_date:a.end_date,description:a.description,technologies:a.technologies?a.technologies.split(",").map(u=>u.trim()).filter(u=>u):[],order_index:a.order_index,user_id:1};if(v){const u=await me(v,n),P=o.map(A=>A.id===v?{...A,...u}:A);b(P),I("Experiencia Actualizada",`Se ha actualizado "${n.title}" correctamente`)}else{const u=await he(n);b([...o,u]),I("Nueva Experiencia Creada",`Se ha creado "${u.title}" correctamente`)}}else{const n={title:a.title,institution:a.institution,start_date:a.start_date,end_date:a.end_date,description:a.description,grade:a.grade,order_index:a.order_index,user_id:1};if(v){const u=await ue(v,n),P=(Array.isArray(h)?h:[]).map(A=>A.id===v?{...A,...u}:A);N(P),I("Educación Actualizada",`Se ha actualizado "${n.title}" correctamente`)}else{const u=await xe(n);N([...Array.isArray(h)?h:[],u]),I("Nueva Formación Académica Creada",`Se ha creado "${u.title}" correctamente`)}}f()}catch(r){console.error("Error al guardar:",r);const n=r instanceof Error?r.message:"Error desconocido";J("Error al Guardar",`No se pudo guardar ${V==="experience"?"la experiencia":"la educación"}: ${n}`)}},se=()=>{O({title:"",company:"",start_date:"",end_date:"",description:"",technologies:"",order_index:0}),K({title:"",institution:"",start_date:"",end_date:"",description:"",grade:"",order_index:0})},oe=()=>{const a=V==="experience",r=a?H:k,n={title:r.title,company:a?H.company:void 0,institution:a?void 0:k.institution,start_date:r.start_date,end_date:r.end_date,description:r.description,technologies:a?H.technologies:void 0,grade:a?void 0:k.grade,order_index:r.order_index,is_current:r.end_date==="Actualmente"||r.end_date==="Presente"};return e.jsx(ba,{isOpen:!0,onClose:f,formType:V,initialData:n,isEditing:!!v,onSubmit:Q})},le=()=>M?oe():$==="experience"?D?e.jsxs("div",{className:"admin-loading",children:[e.jsx("i",{className:"fas fa-spinner fa-spin"}),e.jsx("p",{children:"Cargando experiencias..."})]}):_():L();return D?e.jsx("section",{className:`cv-section ${t||""}`,children:e.jsxs("div",{className:"experience-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Cargando experiencia y formación..."}),e.jsx("div",{className:"loading-details",children:e.jsx("small",{children:"Obteniendo datos del servidor..."})})]})}):C&&o.length===0?e.jsx("section",{className:`cv-section ${t||""}`,children:e.jsxs("div",{className:"experience-error",children:[e.jsx("i",{className:"fas fa-exclamation-triangle"}),e.jsx("p",{children:C}),e.jsxs("button",{className:"retry-button",onClick:q,disabled:w>=3,children:[e.jsx("i",{className:"fas fa-redo"}),w>=3?"Límite de reintentos alcanzado":"Reintentar"]})]})}):e.jsxs("section",{className:`section-cv ${t||""}`,id:"experience",children:[e.jsx(fe,{icon:"fas fa-route",title:"Trayectoria Profesional",subtitle:"Un recorrido por mi experiencia laboral y formación académica, mostrando las tecnologías y logros más relevantes.",className:"experience",showNotification:!!(C&&o.length>0),notificationMessage:C||void 0,notificationIcon:"fas fa-info-circle"}),e.jsxs("div",{className:"section-container",ref:X,children:[e.jsxs("div",{className:"view-toggle-container",children:[e.jsxs("button",{className:`view-toggle-btn ${S==="traditional"?"active":""}`,onClick:()=>W("traditional"),"aria-label":"Vista por categorías",children:[e.jsx("i",{className:"fas fa-columns"}),e.jsx("span",{children:"Vista por Categorías"})]}),e.jsxs("button",{className:`view-toggle-btn ${S==="chronological"?"active":""}`,onClick:()=>W("chronological"),"aria-label":"Vista cronológica",children:[e.jsx("i",{className:"fas fa-clock"}),e.jsx("span",{children:"Vista Cronológica"})]})]}),e.jsxs("div",{className:"experience-stats",children:[e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-number",children:o.length}),e.jsx("span",{className:"stat-label",children:"Experiencias"})]}),e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-number",children:Array.isArray(h)?h.length:0}),e.jsx("span",{className:"stat-label",children:"Certificaciones"})]}),e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-number",children:Array.isArray(o)?o.reduce((a,r)=>{var n;return a+(((n=r.technologies)==null?void 0:n.length)||0)},0):0}),e.jsx("span",{className:"stat-label",children:"Tecnologías"})]})]}),"        ",S==="traditional"&&e.jsxs("div",{className:"experience-grid traditional-view",children:[e.jsxs("div",{className:"experience-column",children:[e.jsxs("div",{className:"column-header",children:[e.jsx("div",{className:"column-icon",children:e.jsx("i",{className:"fas fa-briefcase"})}),e.jsx("h3",{className:"column-title strong-contrast",children:"Experiencia Laboral"})]}),"              ",e.jsx("div",{className:"timeline-container",children:Array.isArray(o)?o.sort((a,r)=>{const n=y(a.end_date);return y(r.end_date)-n}).map((a,r)=>e.jsx(Ne,{experience:a,index:r},a.id)):e.jsx("div",{children:"Cargando experiencias..."})})]}),e.jsxs("div",{className:"education-column",children:[e.jsxs("div",{className:"column-header",children:[e.jsx("div",{className:"column-icon",children:e.jsx("i",{className:"fas fa-graduation-cap"})}),e.jsx("h3",{className:"column-title strong-contrast",children:"Formación Académica"})]}),"              ",e.jsx("div",{className:"timeline-container",children:(Array.isArray(h)?h:[]).sort((a,r)=>{const n=y(a.end_date);return y(r.end_date)-n}).map((a,r)=>e.jsx(_e,{education:a,index:r+(Array.isArray(o)?o.length:0)},a.id))})]})]}),"        ",S==="chronological"&&e.jsx("div",{className:"chronological-view",children:e.jsxs("div",{className:"chronological-timeline",children:[e.jsx("div",{className:"timeline-line"}),[...(Array.isArray(o)?o:[]).map(n=>({...n,type:"experience"})),...(Array.isArray(h)?h:[]).map(n=>({...n,type:"education"}))].sort((n,u)=>{const P=y(n.end_date);return y(u.end_date)-P}).map((n,u)=>e.jsx(ve,{item:n,index:u,position:u%2===0?"left":"right"},`${n.type}-${n.id}`))]})})]}),g&&e.jsx(de,{onClick:()=>{T(!0),x==null||x()},icon:"fas fa-cog",label:"Administrar Experiencia",position:"bottom-right",color:"primary",ariaLabel:"Administrar experiencia laboral"}),"      ",e.jsx(je,{isOpen:R,onClose:()=>T(!1),title:"Administración de Trayectoria",icon:"fas fa-route",maxWidth:"1300px",height:"88vh",tabs:[{id:"experience",label:"Experiencia Laboral",icon:"fas fa-briefcase",content:null},{id:"education",label:"Formación Académica",icon:"fas fa-graduation-cap",content:null}],activeTab:$,onTabChange:a=>E(a),showTabs:!0,floatingActions:M?[{id:"cancel-form",label:"Cancelar",icon:"fas fa-times",onClick:f,variant:"secondary"},{id:"save-form",label:v?"Guardar Cambios":`Crear ${$==="experience"?"Experiencia":"Educación"}`,icon:"fas fa-save",onClick:()=>{const a=document.querySelector(".admin-form");a&&a.requestSubmit()},variant:"primary"}]:[{id:"new-item",label:`Nueva ${$==="experience"?"Experiencia":"Educación"}`,icon:"fas fa-plus",onClick:l,variant:"primary"}],children:e.jsxs("div",{className:"admin-content-wrapper",children:["          ",e.jsx("div",{className:"admin-main-content",children:le()})]})})]})};export{ya as default};
